# 현재 시각 조회 (NOW, SYSDATE)

두 함수 모두 현재의 시간을 반환하는 함수로서 같은 기능을 수행하고 있지만, 작동 방식에 큰 차이가 있습니다.

- NOW()

    - 하나의 SQL에서 모든 NOW() 함수는 같은 값을 가집니다.

    - 쿼리가 실행되는 시점에 NOW() 함수가 실행되고 값을 할당받아서 그 값을 SQL 문장의 모든 부분에서 사용합니다.

    - 아래의 쿼리를 실행해보면 조회되는 시간이 동일합니다.

        - ```sql
      select now(), sleep(2), now() from dual;
      ```

- SYSDATE()

    - 하나의 SQL 내에서도 호출되는 시점에 따라 결괏값이 달라집니다.

    - 쿼리 내에서도 이 함수가 호출될 때마다 다른 값을 반환하므로 상수가 아니며, 인덱스 스캔할 때도 매번 비교되는 레코드마다 함수가 실행되기 때문에 성능이 좋지 않습니다.

    - 아래의 쿼리를 실행해보면 조회되는 시간은 sleep() 함수의 대기 시간인 2초 동안의 차이가 있습니다.

        - ```sql
      select sysdate(), sleep(2), sysdate() from dual;
      ```

SYSDATE() 함수는 이러한 특징 때문에 두 가지 큰 잠재적인 문제가 있습니다.

- SYSDATE() 함수가 사용된 SQL은 레플리카 서버에 안정적으로 복제되지 못합니다.
    - MySQL의 복제 포맷에는 statement, row, mixed 3가지 방식이 있는데, statement 방식의 경우 명령문 기반의 로깅 방식이기 때문에 실행된 SQL문을 그대로 바이너리 로그에 저장하여 소스와 레플리카 서버의 SYSDATE()가 다른 값을 가지게 될 수 있습니다.
- SYSDATE() 함수와 비교되는 컬럼은 인덱스를 효율적으로 사용하지 못합니다.

## 결론

- MySQL 쿼리문 작성할 때, SYSDATE() 는 사용하지 않도록 합시다.
- 오라클의 SYSDATE 대신 MySQL의 NOW()를 사용합시다.